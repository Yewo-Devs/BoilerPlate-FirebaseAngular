import{a as O}from"./chunk-Y6GOW2FQ.js";import{a as N}from"./chunk-5V2RVHJW.js";import{a as G}from"./chunk-DM4JGXTD.js";import"./chunk-MABEPYNM.js";import{a as F}from"./chunk-NE3RI2R4.js";import{e as P,i as j}from"./chunk-MEJR6MZI.js";import"./chunk-VA5MERGI.js";import{a as D}from"./chunk-BWE2EIYQ.js";import"./chunk-GCDBP4HB.js";import"./chunk-E5CH4KVA.js";import"./chunk-U3QUSVWF.js";import{l as C,m as I,r as M,s as B,t as T}from"./chunk-5RQIKTTO.js";import{Ab as d,Bb as E,Cb as k,Ib as S,Jb as f,Oa as a,Pa as u,Tb as n,Ub as w,Vb as b,Wb as g,Za as _,db as y,fa as p,ic as l,jc as v,kc as x,pb as s,yb as e,zb as i}from"./chunk-QP33FRZG.js";import"./chunk-EQDQRRRY.js";function V(r,m){if(r&1&&(e(0,"div",35)(1,"p",36),n(2," Your next payment is "),e(3,"span",37),n(4),l(5,"currency"),i(),n(6,", to be charged on "),e(7,"span",37),n(8),l(9,"date"),i()(),e(10,"p",38),n(11," Your payment will be automatically renewed "),i()()),r&2){let t=f();a(4),g("",v(5,3,t.subscription.price)," ",t.subscription.currency,""),a(4),w(x(9,5,t.subscription.expiryDate,"MMMM dd, yyyy"))}}function L(r,m){if(r&1&&(e(0,"td",45),n(1),l(2,"currency"),e(3,"div",46),p(),e(4,"svg",47),d(5,"circle",48),i(),n(6," Failed "),i()()),r&2){let t=f().$implicit;a(),g(" ",v(2,2,t.amount)," ",t.currency," ")}}function $(r,m){r&1&&(e(0,"td",42)(1,"div",49),p(),e(2,"svg",47),d(3,"circle",48),i(),n(4," Failed "),i()())}function z(r,m){if(r&1&&(e(0,"td",45),n(1),l(2,"currency"),e(3,"div",46),p(),e(4,"svg",50),d(5,"circle",48),i(),n(6," Complete "),i()()),r&2){let t=f().$implicit;a(),g(" ",v(2,2,t.amount)," ",t.currency," ")}}function R(r,m){r&1&&(e(0,"td",42)(1,"div",49),p(),e(2,"svg",50),d(3,"circle",48),i(),n(4," Complete "),i()())}function Y(r,m){if(r&1&&(E(0),e(1,"tr")(2,"td",39),n(3),l(4,"date"),e(5,"div",40)(6,"p",41),n(7),l(8,"date"),i()()(),e(9,"td",42),n(10),l(11,"date"),i(),y(12,L,7,4,"td",43)(13,$,5,0,"td",44)(14,z,7,4,"td",43)(15,R,5,0,"td",44),i(),k()),r&2){let t=m.$implicit;a(3),g(" ",t.itemTitle," Plan - ",x(4,8,t.dateTime,"MMM yyyy")," "),a(4),b(" ",x(8,11,t.dateTime,"dd MMMM, yyyy")," "),a(3),b(" ",x(11,14,t.dateTime,"dd MMMM, yyyy")," "),a(2),s("ngIf",t.status=="Failed"),a(),s("ngIf",t.status=="Failed"),a(),s("ngIf",t.status!="Failed"),a(),s("ngIf",t.status!="Failed")}}var ee=(()=>{class r{constructor(t,c,o,h){this.paymentService=t,this.preferencesService=c,this.toastService=o,this.busyService=h,this.prefs=this.preferencesService.getPreferences(),this.pageSize=5,this.currentPage=1}ngOnInit(){this.getSubscription()}getSubscription(){this.busyService.busy(),this.paymentService.getSubscription(this.prefs.user.id).subscribe(t=>{this.subscription=t,this.getTransactions()},t=>{this.busyService.idle()})}getTransactions(){this.busyService.busy(),this.paymentService.getTransactions(this.prefs.user.id,this.currentPage,this.pageSize).subscribe(t=>{this.transactions=t,this.busyService.idle()},t=>{this.busyService.idle()})}validSubscription(){return this.subscription?this.subscription&&this.subscription.cancellationDate.toString()==="0001-01-01T00:00:00":!1}cancelSubscription(){this.busyService.busy(),this.paymentService.cancelSubscription(this.subscription.subscriptionId).subscribe(t=>{this.toastService.success("Subscription cancelled"),this.busyService.idle(),window.location.reload()},t=>{this.toastService.error("Error cancelling subscription"),this.busyService.idle()})}managePaymentMethod(){this.busyService.busy(),this.paymentService.updatePaymentMethod(this.subscription.subscriptionId).subscribe(t=>{this.busyService.idle(),window.open(t,"_self")},t=>{this.toastService.error("Error updating payment method"),this.busyService.idle()})}static{this.\u0275fac=function(c){return new(c||r)(u(O),u(D),u(F),u(G))}}static{this.\u0275cmp=_({type:r,selectors:[["app-billing"]],decls:56,vars:7,consts:[[1,"bg-gray-50","dark:bg-neutral-900"],[1,"py-6"],[1,"px-4","mx-auto","sm:px-6","md:px-8"],[1,"max-w-md"],[1,"text-lg","font-bold","text-gray-900","dark:text-white"],[1,"mt-2","text-sm","font-medium","leading-6","text-gray-500"],[1,"px-4","mx-auto","mt-8","sm:px-6","md:px-8"],[1,"mt-8","sm:flex","sm:items-center","sm:justify-between"],[1,"text-base","font-bold","text-gray-900","dark:text-white"],[1,"text-indigo-600"],[1,"mt-1","text-sm","font-medium","text-gray-500"],[1,"mt-4","sm:mt-0"],["routerLink","/pricing",1,"inline-flex","mr-4","items-center","justify-center","px-4","py-2","text-sm","font-semibold","leading-5","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"disabled"],[1,"inline-flex","items-center","justify-center","px-4","py-2","text-sm","font-semibold","leading-5","text-gray-600","transition-all","duration-200","bg-transparent","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-500","hover:bg-gray-50","hover:text-gray-900","dark:text-white",3,"click","disabled"],[1,"mt-6","border-gray-200","dark:border-neutral-600"],["class","mt-4 sm:flex sm:items-center sm:justify-between",4,"ngIf"],[1,"mt-8","bg-white","dark:bg-transparent","border","border-gray-200","dark:border-neutral-600","dark:border-neutral-600","rounded-xl"],[1,"px-4","py-5","sm:p-6"],[1,"grid","grid-cols-1","lg:grid-cols-5","lg:gap-x-24","gap-y-8"],[1,"lg:col-span-2"],[1,"mt-2","text-sm","font-medium","text-gray-500"],[1,"lg:col-span-3"],[1,"mt-6"],[1,"inline-flex","items-center","justify-center","text-sm","font-medium","leading-5","text-gray-600","transition-all","duration-200","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-300","hover:text-gray-900","dark:hover:text-gray-600","dark:text-white",3,"click","disabled"],[1,"pi","pi-wallet","mr-4"],[1,"mt-8"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"flex-1","text-base","font-bold","text-gray-900","dark:text-white"],[1,"mt-6","ring-1","ring-gray-300","rounded-2xl"],[1,"min-w-full","lg:divide-y","lg:divide-gray-200","dark:divide-neutral-600"],[1,"hidden","lg:table-header-group"],["width","50%",1,"px-6","py-4","text-sm","font-medium","text-gray-400","whitespace-normal"],[1,"px-6","py-4","text-sm","font-medium","text-gray-400","whitespace-normal"],[1,"divide-y","divide-gray-200","dark:divide-neutral-600"],[4,"ngFor","ngForOf"],[1,"mt-4","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"font-bold"],[1,"mt-2","text-sm","font-medium","text-gray-500","sm:mt-0"],["width","50%",1,"px-6","py-4","text-sm","font-bold","text-gray-900","dark:text-white","whitespace-nowrap"],[1,"mt-1","lg:hidden"],[1,"font-medium","text-gray-500"],[1,"hidden","px-6","py-4","text-sm","font-medium","text-gray-900","dark:text-white","lg:table-cell","whitespace-nowrap"],["class","px-6 py-4 text-sm font-bold text-right text-gray-900 dark:text-white lg:text-left whitespace-nowrap",4,"ngIf"],["class","hidden px-6 py-4 text-sm font-medium text-gray-900 dark:text-white lg:table-cell whitespace-nowrap",4,"ngIf"],[1,"px-6","py-4","text-sm","font-bold","text-right","text-gray-900","dark:text-white","lg:text-left","whitespace-nowrap"],[1,"flex","items-center","justify-end","mt-1","font-medium","lg:hidden"],["fill","currentColor","viewBox","0 0 8 8",1,"mr-1.5","h-2.5","w-2.5","text-red-500"],["cx","4","cy","4","r","3"],[1,"inline-flex","items-center"],["fill","currentColor","viewBox","0 0 8 8",1,"mr-1.5","h-2.5","w-2.5","text-green-500"]],template:function(c,o){c&1&&(e(0,"main",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),n(5," Settings "),i(),e(6,"p",5),n(7," Manage your billing information and payment methods. Update your subscription plan and view your transaction history. "),i()()(),e(8,"div",6),d(9,"app-nav-bread-crumb"),e(10,"div",7)(11,"div")(12,"p",8),n(13," Subscription Plan: "),e(14,"span",9),n(15),i()(),e(16,"p",10),n(17),i()(),e(18,"div",11)(19,"button",12),n(20," Change Plan "),i(),e(21,"button",13),S("click",function(){return o.cancelSubscription()}),n(22," Cancel Subscription "),i()()(),d(23,"hr",14),y(24,V,12,8,"div",15),e(25,"div",16)(26,"div",17)(27,"div",18)(28,"div",19)(29,"p",8),n(30," Payment Method "),i(),e(31,"p",20),n(32," Choose your preferred payment method for making future payments "),i()(),e(33,"div",21)(34,"div",22)(35,"button",23),S("click",function(){return o.managePaymentMethod()}),d(36,"i",24),n(37," Manage Payment Method "),i()()()()()(),e(38,"div",25)(39,"div",26)(40,"p",27),n(41," Latest Transactions "),i()(),e(42,"div",28)(43,"table",29)(44,"thead",30)(45,"tr")(46,"td",31),n(47," Invoice "),i(),e(48,"td",32),n(49," Date "),i(),e(50,"td",32),n(51," Amount "),i(),e(52,"td",32),n(53," Status "),i()()(),e(54,"tbody",33),y(55,Y,16,17,"ng-container",34),i()()()()()()()),c&2&&(a(15),w(o.validSubscription()?o.subscription.itemTitle:"None"),a(2),b(" ",o.validSubscription()?o.subscription.interval+" Plan":""," "),a(2),s("disabled",!o.validSubscription()),a(2),s("disabled",!o.validSubscription()),a(3),s("ngIf",o.validSubscription()),a(11),s("disabled",!o.validSubscription()),a(20),s("ngForOf",o.transactions))},dependencies:[N,B,M,T,C,I,j,P],encapsulation:2})}}return r})();export{ee as BillingComponent};
