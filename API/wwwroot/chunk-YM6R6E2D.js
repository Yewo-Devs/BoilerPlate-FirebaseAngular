import{a as pe,b as ue}from"./chunk-HOR3FU2G.js";import{a as F}from"./chunk-P2REHMKK.js";import{a as ce}from"./chunk-VAQXHD53.js";import{a as de}from"./chunk-APZSJRTK.js";import"./chunk-J5JZ7UON.js";import{a as K}from"./chunk-MAIZ6JXJ.js";import{a as se,c as le}from"./chunk-XOURAERD.js";import"./chunk-MHIUT2CF.js";import{d as y,f as Q,g as X,i as Y,j as Z,k as ee,l as te,m as ie,n as re,o as ne,p as oe,r as ae}from"./chunk-GUU2YENF.js";import"./chunk-T7B252WK.js";import"./chunk-DZNB6D3O.js";import{h as J,o as U}from"./chunk-XWDU3J6L.js";import{a as me}from"./chunk-AEHWLKGT.js";import{a as h}from"./chunk-6U5655YX.js";import{a as H}from"./chunk-HLDRKBUV.js";import"./chunk-U3QUSVWF.js";import{l as q,m as z,r as L}from"./chunk-ZN3S7RNM.js";import{$b as E,Cb as i,Db as r,Eb as g,Fb as V,Gb as N,Ib as w,Mb as b,Nb as f,Pa as T,Qb as P,Sa as s,Ta as v,U as A,V as S,Wb as G,Xb as n,Z as W,Zb as M,_b as O,ac as k,bb as B,bc as I,cb as C,ha as d,hb as x,ia as c,tb as l}from"./chunk-L2D5CQS2.js";var be=(()=>{class o{constructor(e){this.httpClient=e}createInvitation(e){return this.httpClient.post(`${h.apiUrl}team/invite`,e)}getTeamById(e){return this.httpClient.get(`${h.apiUrl}team/get-team?id=${e}`)}getAllUserTeams(e){return this.httpClient.get(`${h.apiUrl}team/get-user-teams?userId=${e}`)}createTeam(e){return this.httpClient.post(`${h.apiUrl}team/create`,e)}updateTeam(e){return this.httpClient.put(`${h.apiUrl}team/update`,e)}deleteTeam(e){return this.httpClient.delete(`${h.apiUrl}team/delete?id=${e}`)}acceptInvite(e,a,t){return this.httpClient.put(`${h.apiUrl}team/accept-invite?teamId=${e}&inviteId=${a}&userId=${t}`,{})}static{this.\u0275fac=function(a){return new(a||o)(W(H))}}static{this.\u0275prov=A({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function xe(o,_){if(o&1&&(i(0,"div",52),g(1,"img",53),r()),o&2){let e=f().$implicit;s(),P("src",e.teamPhotoUrl,T)}}function we(o,_){if(o&1){let e=w();V(0),i(1,"div",45)(2,"div",46),x(3,xe,2,1,"div",47),i(4,"div",48)(5,"p",49),n(6),r(),i(7,"p",10),n(8),r()(),i(9,"div",50)(10,"a",51),b("click",function(){let t=d(e).$implicit,m=f();return c(m.viewTeam(t))}),n(11," View "),r()()()(),N()}if(o&2){let e=_.$implicit;s(3),l("ngIf",e.teamPhotoUrl),s(3),M(" ",e.name," "),s(2),O(" ",e.members.length," ",e.members.length===1?"member":"members"," ")}}function ye(o,_){if(o&1&&(i(0,"div",52),g(1,"img",53),r()),o&2){let e=f().$implicit;s(),P("src",e.photoUrl,T)}}function Se(o,_){if(o&1){let e=w();i(0,"button",57),b("click",function(){d(e);let t=f().$implicit,m=f();return c(m.removeFromTeam(t.userId))}),n(1," Remove "),r()}if(o&2){let e=f(2);l("disabled",!e.isOwner())}}function Te(o,_){if(o&1){let e=w();i(0,"button",58),b("click",function(){d(e);let t=f().$implicit,m=f();return c(m.showDialogEditMember(t.userId))}),n(1," Edit "),r()}if(o&2){let e=f(2);l("disabled",!e.isOwner())}}function Ce(o,_){if(o&1&&(V(0),i(1,"div",45)(2,"div",46),x(3,ye,2,1,"div",47),i(4,"div",48)(5,"p",49),n(6),r(),i(7,"p",10),n(8),r()(),i(9,"div",54),x(10,Se,2,1,"button",55)(11,Te,2,1,"button",56),r()()(),N()),o&2){let e=_.$implicit,a=f();s(3),l("ngIf",e.photoUrl),s(3),O(" ",e.firstName," ",e.lastName," "),s(2),M(" ",a.getRole(e.userId)," "),s(2),l("ngIf",a.getRole(e.userId)!=="Owner"),s(),l("ngIf",a.getRole(e.userId)!=="Owner")}}var fe=(()=>{class o{constructor(e,a,t,m,p,u,ge){this.teamService=e,this.route=a,this.busyService=t,this.toastService=m,this.preferencesService=p,this.profileService=u,this.fb=ge,this.teams=[],this.prefs=this.preferencesService.getPreferences(),this.visibleNewTeam=!1,this.visibleNewMember=!1,this.visibleEditMember=!1,this.teamMembers=[],this.route.queryParams.subscribe(R=>{let D=R.teamId,$=R.inviteId;D&&$&&(this.busyService.busy(),this.teamService.acceptInvite(D,$,this.prefs.user.id).subscribe(he=>{this.toastService.success("Invitation accepted"),this.busyService.idle(),window.location.href=window.location.origin+window.location.pathname},he=>{this.toastService.error("Failed to accept invitation"),this.busyService.idle()}))}),this.teamForm=this.fb.group({teamPhotoUrl:[""],name:["",y.required]}),this.memberForm=this.fb.group({emails:["",y.required],role:["",y.required]}),this.editMemberForm=this.fb.group({role:["",y.required]})}ngOnInit(){this.busyService.busy(),this.teamService.getAllUserTeams(this.prefs.user.id).subscribe(e=>{this.teams=e,this.viewTeam(this.teams[0]),this.busyService.idle()})}showDialogNewTeam(){this.visibleNewTeam=!0}showDialogNewMember(){this.visibleNewMember=!0}showDialogEditMember(e){this.visibleEditMember=!0,this.selectedUserId=e,this.editMemberForm.get("role").setValue(this.getRole(e))}removePhoto(){this.teamForm.get("teamPhotoUrl").setValue("")}updatePhoto(e){let a=e.target;if(a.files&&a.files[0]){let t=new FileReader;t.onload=m=>{this.teamForm.get("teamPhotoUrl").setValue(m.target.result)},t.readAsDataURL(a.files[0])}}createTeam(){let e={teamPhotoUrl:this.teamForm.get("teamPhotoUrl").value,name:this.teamForm.get("name").value,members:[{userId:this.prefs.user.id,role:"Owner"}],invites:[]};this.busyService.busy(),this.teamService.createTeam(e).subscribe(a=>{this.toastService.success("Team created successfully"),this.visibleNewTeam=!1,this.teams.push(a),this.viewTeam(this.teams[0]),this.busyService.idle()},a=>{this.toastService.error("Failed to create team"),this.busyService.idle()})}viewTeam(e){e&&(this.selectedTeam=e,this.teamMembers=[],e.members.forEach(a=>{this.profileService.getProfile(a.userId).subscribe(t=>{this.teamMembers.find(m=>m.userId===t.userId)||this.teamMembers.push(t)})}))}getRole(e){return this.selectedTeam?this.selectedTeam.members.find(a=>a.userId===e).role:""}isOwner(){return this.getRole(this.prefs.user.id)==="Owner"}addMembers(){let e=this.memberForm.get("emails").value.split(","),a=this.memberForm.get("role").value;e.forEach(t=>{let m={teamId:this.selectedTeam.id,email:t,role:a};this.teamService.createInvitation(m).subscribe(p=>{this.toastService.success("Invitation sent to "+t),this.visibleNewMember=!1},p=>{this.toastService.error("Failed to send invitation to "+t)})})}removeFromTeam(e){let a={id:this.selectedTeam.id,name:this.selectedTeam.name,members:this.selectedTeam.members.filter(t=>t.userId!==e),invites:this.selectedTeam.invites};this.busyService.busy(),this.teamService.updateTeam(a).subscribe(t=>{this.toastService.success("Member removed from team"),this.busyService.idle(),window.location.reload()},t=>{this.toastService.error("Failed to remove member from team"),this.busyService.idle()})}editTeamMember(){let e={id:this.selectedTeam.id,name:this.selectedTeam.name,members:this.selectedTeam.members,invites:this.selectedTeam.invites},a=this.editMemberForm.get("role").value;e.members.forEach(t=>{t.userId===this.selectedUserId&&(t.role=a)}),this.busyService.busy(),this.teamService.updateTeam(e).subscribe(t=>{this.toastService.success("Member updated"),this.busyService.idle(),window.location.reload()},t=>{this.toastService.error("Failed to update member"),this.busyService.idle()})}static{this.\u0275fac=function(a){return new(a||o)(v(be),v(J),v(de),v(K),v(me),v(ce),v(oe))}}static{this.\u0275cmp=B({type:o,selectors:[["app-team"]],standalone:!1,decls:136,vars:25,consts:[["fileInput",""],[1,"bg-gray-50","dark:bg-neutral-900"],[1,"py-6"],[1,"px-4","mx-auto","sm:px-6","md:px-8"],[1,"max-w-md"],[1,"text-lg","font-bold","text-gray-900","dark:text-white"],[1,"mt-2","text-sm","font-medium","leading-6","text-gray-500"],[1,"px-4","mx-auto","mt-8","sm:px-6","md:px-8"],[1,"mt-8"],[1,"text-base","font-bold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","font-medium","text-gray-500"],[1,"mt-6","border-gray-200","dark:border-neutral-600"],[1,"px-4","mx-auto","mt-8","max-w-7xl"],[1,"mt-8","overflow-hidden","bg-white","dark:bg-transparent","border","border-gray-200","dark:border-neutral-600","rounded-xl"],[1,"px-4","py-5","sm:p-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"mt-4","sm:mt-0"],["type","button",1,"inline-flex","items-center","justify-center","px-5","py-3","text-sm","font-semibold","leading-4","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click"],[3,"visibleChange","modal","visible"],[1,"w-full","max-w-sm","bg-white","dark:bg-transparent","shadow-lg","rounded-xl"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],[1,"mt-3","text-sm","font-medium","text-gray-500"],[1,"mt-6",3,"formGroup"],[1,"space-y-4"],["for","",1,"text-sm","font-bold","text-gray-900","dark:text-white"],[1,"sm:col-span-2"],[1,"flex","items-center","space-x-6"],["alt","",1,"flex-shrink-0","object-cover","w-12","h-12","rounded-lg",3,"src"],["type","button",1,"text-sm","font-semibold","text-gray-400","transition-all","duration-200","rounded-md","hover:text-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-600",3,"click"],["type","button",1,"text-sm","font-semibold","text-indigo-600","transition-all","duration-200","rounded-md","hover:text-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600",3,"click"],["type","file",2,"display","none",3,"change"],[1,"mt-2"],[3,"type","formControl","placeholder","label"],[1,"flex","items-center","justify-end","mt-5","space-x-4"],["type","reset",1,"inline-flex","items-center","justify-center","px-6","py-3","text-sm","font-semibold","leading-5","text-gray-600","transition-all","duration-200","bg-white","dark:bg-transparent","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-500","hover:bg-gray-50","hover:text-gray-900","dark:text-white",3,"click"],[1,"inline-flex","items-center","justify-center","px-6","py-3","text-sm","font-semibold","leading-5","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click","disabled"],[1,"flow-root","mt-8"],[1,"-my-5","divide-y","divide-gray-100","dark:divide-neutral-600"],[4,"ngFor","ngForOf"],[1,"inline-flex","items-center","justify-center","px-5","py-3","text-sm","font-semibold","leading-4","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click","disabled"],[1,"mt-2","custom-select"],["formControlName","role",1,"block","w-full","px-4","py-3","placeholder-gray-500","border","-gray-300","rounded-lg","focus:ring-gray-900","focus:border-gray-900","sm:text-sm","caret-gray-900"],["value","Manager"],["value","Editor"],["value","Viewer"],[1,"py-5"],[1,"flex","items-center"],["class","relative flex-shrink-0",4,"ngIf"],[1,"ml-4"],[1,"text-sm","font-bold","text-gray-900","dark:text-white"],[1,"ml-auto"],[1,"text-sm","font-medium","text-gray-400","transition-all","duration-200","hover:text-gray-900","dark:text-white",3,"click"],[1,"relative","flex-shrink-0"],["alt","",1,"object-cover","w-10","h-10","rounded-full",3,"src"],[1,"flex","items-center","justify-end","ml-auto","space-x-8"],["class","text-sm font-medium text-gray-400 transition-all duration-200 hover:text-gray-900 dark:text-white",3,"disabled","click",4,"ngIf"],["class","text-sm font-medium text-indigo-600 transition-all duration-200 hover:text-indigo-700",3,"disabled","click",4,"ngIf"],[1,"text-sm","font-medium","text-gray-400","transition-all","duration-200","hover:text-gray-900","dark:text-white",3,"click","disabled"],[1,"text-sm","font-medium","text-indigo-600","transition-all","duration-200","hover:text-indigo-700",3,"click","disabled"]],template:function(a,t){if(a&1){let m=w();i(0,"main",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),n(5," Settings "),r(),i(6,"p",6),n(7," Manage your team settings and preferences here. "),r()()(),i(8,"div",7),g(9,"app-nav-bread-crumb"),i(10,"div",8)(11,"h1",9),n(12,"Team"),r(),i(13,"p",10),n(14," View and manage your team members. "),r()(),g(15,"hr",11),i(16,"main")(17,"div",2)(18,"div",12)(19,"div",13)(20,"div",14)(21,"div",15)(22,"div")(23,"p",9),n(24," My Teams "),r(),i(25,"p",10),n(26," Here are the teams you are a part of. "),r()(),i(27,"div",16)(28,"button",17),b("click",function(){return d(m),c(t.showDialogNewTeam())}),n(29," Create Team "),r()()(),i(30,"p-dialog",18),I("visibleChange",function(u){return d(m),k(t.visibleNewTeam,u)||(t.visibleNewTeam=u),c(u)}),i(31,"div",19)(32,"div",14)(33,"p",20),n(34," Create New Team "),r(),i(35,"p",21),n(36," Fill out the form below to create a new team. "),r(),i(37,"form",22)(38,"div",23)(39,"div")(40,"label",24),n(41," Team Photo "),r(),i(42,"div",16)(43,"div",25)(44,"div",26),g(45,"img",27),i(46,"button",28),b("click",function(){return d(m),c(t.removePhoto())}),n(47," Remove "),r(),i(48,"button",29),b("click",function(){d(m);let u=G(51);return c(u.click())}),n(49," Select "),r(),i(50,"input",30,0),b("change",function(u){return d(m),c(t.updatePhoto(u))}),r()()()()()(),i(52,"div",23)(53,"div")(54,"label",24),n(55," Team Name "),r(),i(56,"div",31),g(57,"app-text-input",32),r()()(),i(58,"div",33)(59,"button",34),b("click",function(){return d(m),t.visibleNewTeam=!1,c(t.teamForm.reset())}),n(60," Cancel "),r(),i(61,"button",35),b("click",function(){return d(m),c(t.teamForm.valid&&t.createTeam())}),n(62," Add "),r()()()()()(),i(63,"div",36)(64,"div",37),x(65,we,12,4,"ng-container",38),r()()()(),i(66,"div",13)(67,"div",14)(68,"div",15)(69,"div")(70,"p",9),n(71),r(),i(72,"p",10),n(73," Manage your team members here. "),r()(),i(74,"div",16)(75,"button",39),b("click",function(){return d(m),c(t.showDialogNewMember())}),n(76," Add New Member "),r()()(),i(77,"p-dialog",18),I("visibleChange",function(u){return d(m),k(t.visibleNewMember,u)||(t.visibleNewMember=u),c(u)}),i(78,"div",19)(79,"div",14)(80,"p",20),n(81," Add New Members "),r(),i(82,"p",21),n(83," Enter the email addresses of new members, separated by commas. "),r(),i(84,"form",22)(85,"div",23)(86,"div")(87,"label",24),n(88,"Email Addresses"),r(),i(89,"div",31),g(90,"app-text-input",32),r()()(),i(91,"div",23)(92,"div")(93,"label",24),n(94,"Role"),r(),i(95,"div",40)(96,"select",41)(97,"option",42),n(98,"Manager"),r(),i(99,"option",43),n(100,"Editor"),r(),i(101,"option",44),n(102,"Viewer"),r()()()()(),i(103,"div",33)(104,"button",34),b("click",function(){return d(m),t.visibleNewMember=!1,c(t.memberForm.reset())}),n(105," Cancel "),r(),i(106,"button",35),b("click",function(){return d(m),c(t.memberForm.valid&&t.addMembers())}),n(107," Add "),r()()()()()(),i(108,"p-dialog",18),I("visibleChange",function(u){return d(m),k(t.visibleEditMember,u)||(t.visibleEditMember=u),c(u)}),i(109,"div",19)(110,"div",14)(111,"p",20),n(112," Edit Member Role "),r(),i(113,"p",21),n(114," Change the role of the selected member. "),r(),i(115,"form",22)(116,"div",23)(117,"div")(118,"label",24),n(119,"Role"),r(),i(120,"div",40)(121,"select",41)(122,"option",42),n(123,"Manager"),r(),i(124,"option",43),n(125,"Editor"),r(),i(126,"option",44),n(127,"Viewer"),r()()()()(),i(128,"div",33)(129,"button",34),b("click",function(){return d(m),t.visibleEditMember=!1,c(t.editMemberForm.reset())}),n(130," Cancel "),r(),i(131,"button",35),b("click",function(){return d(m),c(t.editMemberForm.valid&&t.editTeamMember())}),n(132," Save "),r()()()()()(),i(133,"div",36)(134,"div",37),x(135,Ce,12,6,"ng-container",38),r()()()()()()()()()()}a&2&&(s(30),l("modal",!0),E("visible",t.visibleNewTeam),s(7),l("formGroup",t.teamForm),s(8),l("src",t.teamForm.get("teamPhotoUrl").value?t.teamForm.get("teamPhotoUrl").value:"../../../../assets/images/img.svg",T),s(12),l("type","text")("formControl",t.teamForm.get("name"))("placeholder","Team Name")("label","team name"),s(4),l("disabled",!t.teamForm.valid),s(4),l("ngForOf",t.teams),s(6),M(" ",t.selectedTeam?t.selectedTeam.name:"Team"," Members "),s(4),l("disabled",!t.isOwner()),s(2),l("modal",!0),E("visible",t.visibleNewMember),s(7),l("formGroup",t.memberForm),s(6),l("type","text")("formControl",t.memberForm.get("emails"))("placeholder","Email Addresses")("label","email addresses"),s(16),l("disabled",!t.memberForm.valid),s(2),l("modal",!0),E("visible",t.visibleEditMember),s(7),l("formGroup",t.editMemberForm),s(16),l("disabled",!t.editMemberForm.valid),s(4),l("ngForOf",t.teamMembers))},dependencies:[F,Y,re,ne,ie,Q,X,Z,ee,te,q,z,pe,se],styles:['[_nghost-%COMP%]     .p-dialog-header{display:none}[_nghost-%COMP%]     .p-dialog .p-dialog-content:last-of-type{border-radius:6px}[_nghost-%COMP%]     .p-dialog .p-dialog-content{padding:0}a[_ngcontent-%COMP%]{cursor:pointer}.custom-select[_ngcontent-%COMP%]{position:relative}.select-selected[_ngcontent-%COMP%]:after{position:absolute;content:"";top:14px;right:100px;width:0;height:0;border:6px solid transparent;border-color:#fff transparent transparent transparent}.select-selected.select-arrow-active[_ngcontent-%COMP%]:after{border-color:transparent transparent #fff transparent;top:7px}.select-items[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .select-selected[_ngcontent-%COMP%]{color:#fff;padding:8px 16px;border:1px solid transparent;border-color:transparent transparent rgba(0,0,0,.1) transparent;cursor:pointer}.select-items[_ngcontent-%COMP%]{position:absolute;background-color:#1e90ff;top:100%;left:0;right:0;z-index:99}.select-hide[_ngcontent-%COMP%]{display:none}.select-items[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover, .same-as-selected[_ngcontent-%COMP%]{background-color:#0000001a}@media (max-width: 768px){[_nghost-%COMP%]     .p-dialog{width:90%!important}}']})}}return o})();var Me=[{path:"",component:fe}],ve=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=C({type:o})}static{this.\u0275inj=S({imports:[U.forChild(Me),U]})}}return o})();var Ye=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=C({type:o})}static{this.\u0275inj=S({imports:[F,ae,L,ve,ue,le]})}}return o})();export{Ye as TeamModule};
