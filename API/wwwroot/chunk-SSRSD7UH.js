import{a as G}from"./chunk-P2REHMKK.js";import{a as T}from"./chunk-VAQXHD53.js";import{a as D}from"./chunk-APZSJRTK.js";import"./chunk-J5JZ7UON.js";import{a as F}from"./chunk-MAIZ6JXJ.js";import{a as I,c as j}from"./chunk-XOURAERD.js";import"./chunk-MHIUT2CF.js";import{d as v,f as P,g as k,i as w,j as _,k as C,p as N,r as U}from"./chunk-GUU2YENF.js";import{f as V}from"./chunk-T7B252WK.js";import"./chunk-DZNB6D3O.js";import"./chunk-XWDU3J6L.js";import{a as E}from"./chunk-AEHWLKGT.js";import"./chunk-6U5655YX.js";import"./chunk-HLDRKBUV.js";import"./chunk-U3QUSVWF.js";import"./chunk-ZN3S7RNM.js";import{Cb as t,Db as i,Eb as a,Ib as y,Mb as h,Pa as x,Sa as n,Ta as p,Wb as S,Xb as o,bb as b,ha as c,ia as u,tb as l}from"./chunk-L2D5CQS2.js";var W=(()=>{class g{constructor(m,r,e,s,d,f){this.fb=m,this.preferencesService=r,this.profileService=e,this.busyService=s,this.accountService=d,this.toastService=f,this.prefs=this.preferencesService.getPreferences()}removePhoto(){this.profileForm.get("photoUrl").setValue("")}updatePhoto(m){let r=m.target;if(r.files&&r.files[0]){let e=new FileReader;e.onload=s=>{this.profileForm.get("photoUrl").setValue(s.target.result)},e.readAsDataURL(r.files[0])}}ngOnInit(){this.profileForm=this.fb.group({firstName:["",v.required],lastName:["",v.required],email:["",[v.required,v.email]],photoUrl:[""],username:[""]}),this.profileForm.controls.firstName.setValue(this.prefs.profile.firstName),this.profileForm.controls.lastName.setValue(this.prefs.profile.lastName),this.profileForm.controls.email.setValue(this.prefs.user.email),this.profileForm.controls.photoUrl.setValue(this.prefs.profile.photoUrl),this.profileForm.controls.username.setValue(this.prefs.user.username)}onSubmit(){this.busyService.busy();let m={userId:this.prefs.user.id,firstName:this.profileForm.controls.firstName.value,lastName:this.profileForm.controls.lastName.value,photoUrl:this.profileForm.controls.photoUrl.value},r={id:this.prefs.user.id,accountEnabled:!0,email:this.profileForm.controls.email.value,username:this.profileForm.controls.username.value,role:this.prefs.user.role,permissions:this.prefs.user.permissions};this.accountService.editUser(r).subscribe(e=>{this.prefs.user=e,this.preferencesService.setPreferences(this.prefs),this.accountService.setUser(e)}),this.profileService.editProfile(m).subscribe(e=>{this.toastService.success("Profile updated successfully"),this.busyService.idle(),this.profileService.getProfile(this.prefs.user.id).subscribe(s=>{this.prefs.profile=s,this.preferencesService.setPreferences(this.prefs)})},e=>{this.toastService.error("Profile update failed"),this.busyService.idle()})}static{this.\u0275fac=function(r){return new(r||g)(p(N),p(E),p(T),p(D),p(V),p(F))}}static{this.\u0275cmp=b({type:g,selectors:[["app-profile"]],decls:53,vars:19,consts:[["fileInput",""],[1,"bg-gray-50","dark:bg-neutral-900"],[1,"py-6"],[1,"px-4","mx-auto","sm:px-6","md:px-8"],[1,"max-w-md"],[1,"text-lg","font-bold","text-gray-900","dark:text-white","dark:text-white"],[1,"mt-2","text-sm","font-medium","leading-6","text-gray-500"],[1,"px-4","mx-auto","mt-8","sm:px-6","md:px-8"],[1,"mt-8"],[1,"text-base","font-bold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","font-medium","text-gray-500"],[1,"mt-6","border-gray-200"],[1,"max-w-5xl","mt-12",3,"formGroup"],[1,"space-y-8"],[1,"sm:grid","sm:grid-cols-3","sm:gap-5","sm:items-start"],["for","profilePhoto",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"mt-2","sm:mt-0","sm:col-span-2"],[1,"flex","items-center","space-x-6"],["alt","",1,"flex-shrink-0","object-cover","w-12","h-12","rounded-lg",3,"src"],["type","button",1,"text-sm","font-semibold","text-gray-400","transition-all","duration-200","rounded-md","hover:text-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-600",3,"click"],["type","button",1,"text-sm","font-semibold","text-indigo-600","transition-all","duration-200","rounded-md","hover:text-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600",3,"click"],["type","file",2,"display","none",3,"change"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-x-4","gap-y-5"],[3,"type","formControl","placeholder","label"],[1,"sm:mt-px","sm:pt-2"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mt-6","sm:mt-12"],[1,"inline-flex","items-center","justify-center","px-5","py-3","text-sm","font-semibold","leading-4","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click","disabled"]],template:function(r,e){if(r&1){let s=y();t(0,"main",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),o(5," Settings "),i(),t(6,"p",6),o(7," Update your profile information below to keep your account up to date. "),i()()(),t(8,"div",7),a(9,"app-nav-bread-crumb"),t(10,"div",8)(11,"h1",9),o(12," Profile "),i(),t(13,"p",10),o(14," Please ensure your profile information is accurate and up-to-date. "),i()(),a(15,"hr",11),t(16,"form",12)(17,"div",13)(18,"div",14)(19,"label",15),o(20," Profile Photo "),i(),t(21,"div",16)(22,"div",17),a(23,"img",18),t(24,"button",19),h("click",function(){return c(s),u(e.removePhoto())}),o(25," Remove "),i(),t(26,"button",20),h("click",function(){c(s);let f=S(29);return u(f.click())}),o(27," Update "),i(),t(28,"input",21,0),h("change",function(f){return c(s),u(e.updatePhoto(f))}),i()()()(),t(30,"div",14)(31,"label",22),o(32," First & Last Name "),i(),t(33,"div",16)(34,"div",23)(35,"div"),a(36,"app-text-input",24),i(),t(37,"div"),a(38,"app-text-input",24),i()()()(),t(39,"div",14)(40,"label",22),o(41," Email Address "),i(),t(42,"div",16),a(43,"app-text-input",24),i()(),t(44,"div",14)(45,"div",25)(46,"label",26),o(47," Username "),i()(),t(48,"div",16),a(49,"app-text-input",24),i()()(),t(50,"div",27)(51,"button",28),h("click",function(){return c(s),u(e.profileForm.valid&&e.onSubmit())}),o(52," Update "),i()()()()()()}r&2&&(n(16),l("formGroup",e.profileForm),n(7),l("src",e.profileForm.get("photoUrl").value?e.profileForm.get("photoUrl").value:"../../../../assets/images/img.svg",x),n(13),l("type","text")("formControl",e.profileForm.get("firstName"))("placeholder","First Name")("label","first name"),n(2),l("type","text")("formControl",e.profileForm.get("lastName"))("placeholder","Last Name")("label","last name"),n(5),l("type","text")("formControl",e.profileForm.get("email"))("placeholder","Email")("label","email"),n(6),l("type","text")("formControl",e.profileForm.get("username"))("placeholder","Username")("label","username"),n(2),l("disabled",!e.profileForm.valid))},dependencies:[G,U,w,P,k,_,C,j,I],encapsulation:2})}}return g})();export{W as ProfileComponent};
