import './polyfills.server.mjs';
import{a as B,b as G}from"./chunk-7GLKTVSD.mjs";import"./chunk-EHLKKJOI.mjs";import"./chunk-CTEN2AF6.mjs";import{a as q}from"./chunk-SHKAJHM7.mjs";import{a as j}from"./chunk-3VPIIOTU.mjs";import{a as M}from"./chunk-W4KCEUCZ.mjs";import"./chunk-S5LLE7VL.mjs";import{a as w}from"./chunk-TRCGT4ME.mjs";import{a as A}from"./chunk-VMTRNC42.mjs";import"./chunk-4EQ3CSFW.mjs";import"./chunk-P5XOHON5.mjs";import{f as T}from"./chunk-2UEZCBOK.mjs";import{d as m,f as U,g as C,i as E,j as P,k as N,l as _,m as k,n as R,o as I,p as V,r as D}from"./chunk-JUYC4XRN.mjs";import"./chunk-D5MSRIRL.mjs";import"./chunk-ZTZUQXOY.mjs";import{a as F}from"./chunk-PMTGJU2L.mjs";import"./chunk-EWKNIMHR.mjs";import"./chunk-RKHYJ25K.mjs";import"./chunk-D2P6BBTD.mjs";import"./chunk-PBUWRJ2U.mjs";import"./chunk-4CMVCGMC.mjs";import{Bb as e,Cb as t,Db as a,Hb as x,Lb as f,Oa as S,Ra as n,Sa as p,Vb as y,Wb as r,ab as b,da as c,ea as u,sb as l}from"./chunk-JQ55PVVS.mjs";import"./chunk-S6KH3LOX.mjs";var O=class h{constructor(d,o,i,s,v,g){this.fb=d;this.preferencesService=o;this.profileService=i;this.busyService=s;this.accountService=v;this.toastService=g;this.prefs=o.getPreferences()}profileForm;prefs;permissions=["Account Management","Customer"];removePhoto(){this.profileForm.get("photoUrl").setValue("")}updatePhoto(d){let o=d.target;if(o.files&&o.files[0]){let i=new FileReader;i.onload=s=>{this.profileForm.get("photoUrl").setValue(s.target.result)},i.readAsDataURL(o.files[0])}}ngOnInit(){this.profileForm=this.fb.group({firstName:["",m.required],lastName:["",m.required],email:["",[m.required,m.email]],role:["Admin",m.required],permissions:[[],m.required],password:["",m.required],photoUrl:[""],username:[""]})}onSubmit(){this.busyService.busy();let d={email:this.profileForm.controls.email.value,username:this.profileForm.controls.username.value,role:this.profileForm.controls.role.value,permissions:this.profileForm.controls.permissions.value,password:this.profileForm.controls.password.value,requireEmailVerification:!1};this.accountService.registerUser(d).subscribe(o=>{let i={userId:o.id,firstName:this.profileForm.controls.firstName.value,lastName:this.profileForm.controls.lastName.value,photoUrl:this.profileForm.controls.photoUrl.value};this.profileService.createProfile(i).subscribe(s=>{this.toastService.success("Profile created successfully"),this.profileForm.reset({firstName:"",lastName:"",email:"",role:"Admin",permissions:[],accountEnabled:!0,photoUrl:"",username:"",userToEdit:null}),this.busyService.idle()},s=>{this.toastService.error("Profile update failed"),this.busyService.idle()})})}static \u0275fac=function(o){return new(o||h)(p(V),p(F),p(q),p(M),p(T),p(w))};static \u0275cmp=b({type:h,selectors:[["app-register-user"]],decls:66,vars:24,consts:[["fileInput",""],[1,"bg-gray-50","dark:bg-neutral-900"],[1,"py-6"],[1,"px-4","mx-auto","sm:px-6","md:px-8"],[1,"max-w-md"],[1,"text-lg","font-bold","text-gray-900","dark:text-white","dark:text-white"],[1,"px-4","mx-auto","mt-8","sm:px-6","md:px-8"],[1,"mt-6","border-gray-200"],[1,"max-w-5xl","mt-12",3,"formGroup"],[1,"space-y-8"],[1,"sm:grid","sm:grid-cols-3","sm:gap-5","sm:items-start"],["for","profilePhoto",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"mt-2","sm:mt-0","sm:col-span-2"],[1,"flex","items-center","space-x-6"],["loading","lazy","alt","",1,"flex-shrink-0","object-cover","w-12","h-12","rounded-lg",3,"src"],["type","button",1,"text-sm","font-semibold","text-gray-400","transition-all","duration-200","rounded-md","hover:text-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-600",3,"click"],["type","button",1,"text-sm","font-semibold","text-indigo-600","transition-all","duration-200","rounded-md","hover:text-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600",3,"click"],["type","file",2,"display","none",3,"change"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-x-4","gap-y-5"],[3,"type","formControl","placeholder","label"],[1,"sm:mt-px","sm:pt-2"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","role",1,"block","w-full","px-4","py-3","placeholder-gray-500","border","-gray-300","rounded-lg","focus:ring-gray-900","focus:border-gray-900","sm:text-sm","caret-gray-900"],["value","Admin"],["value","User"],["formControlName","permissions","placeholder","Select Permissions","styleClass","w-full",3,"options"],[1,"mt-6","sm:mt-12"],[1,"inline-flex","items-center","justify-center","px-5","py-3","text-sm","font-semibold","leading-4","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click","disabled"]],template:function(o,i){if(o&1){let s=x();e(0,"main",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),r(5," Register User "),t()()(),e(6,"div",6),a(7,"hr",7),e(8,"form",8)(9,"div",9)(10,"div",10)(11,"label",11),r(12," Profile Photo "),t(),e(13,"div",12)(14,"div",13),a(15,"img",14),e(16,"button",15),f("click",function(){return c(s),u(i.removePhoto())}),r(17," Remove "),t(),e(18,"button",16),f("click",function(){c(s);let g=y(21);return u(g.click())}),r(19," Update "),t(),e(20,"input",17,0),f("change",function(g){return c(s),u(i.updatePhoto(g))}),t()()()(),e(22,"div",10)(23,"label",18),r(24," First & Last Name "),t(),e(25,"div",12)(26,"div",19)(27,"div"),a(28,"app-text-input",20),t(),e(29,"div"),a(30,"app-text-input",20),t()()()(),e(31,"div",10)(32,"label",18),r(33," Email Address "),t(),e(34,"div",12),a(35,"app-text-input",20),t()(),e(36,"div",10)(37,"label",18),r(38," Password "),t(),e(39,"div",12),a(40,"app-text-input",20),t()(),e(41,"div",10)(42,"div",21)(43,"label",22),r(44," Username "),t()(),e(45,"div",12),a(46,"app-text-input",20),t()(),e(47,"div",10)(48,"div",21)(49,"label",22),r(50," Role "),t()(),e(51,"div",12)(52,"select",23)(53,"option",24),r(54,"Admin"),t(),e(55,"option",25),r(56,"User"),t()()()(),e(57,"div",10)(58,"div",21)(59,"label",22),r(60," Permissions "),t()(),e(61,"div",12),a(62,"p-multiselect",26),t()()(),e(63,"div",27)(64,"button",28),f("click",function(){return c(s),u(i.profileForm.valid&&i.onSubmit())}),r(65," Register "),t()()()()()()}o&2&&(n(8),l("formGroup",i.profileForm),n(7),l("src",i.profileForm.get("photoUrl").value?i.profileForm.get("photoUrl").value:"../../../../assets/images/img.svg",S),n(13),l("type","text")("formControl",i.profileForm.get("firstName"))("placeholder","First Name")("label","first name"),n(2),l("type","text")("formControl",i.profileForm.get("lastName"))("placeholder","Last Name")("label","last name"),n(5),l("type","text")("formControl",i.profileForm.get("email"))("placeholder","Email")("label","email"),n(5),l("type","password")("formControl",i.profileForm.get("password"))("placeholder","Password")("label","password"),n(6),l("type","text")("formControl",i.profileForm.get("username"))("placeholder","Username")("label","username"),n(16),l("options",i.permissions),n(2),l("disabled",!i.profileForm.valid))},dependencies:[D,E,R,I,k,U,C,P,N,_,A,j,G,B],encapsulation:2})};export{O as RegisterUserComponent};
