import{a as B}from"./chunk-UZCAFMJX.js";import{a as j}from"./chunk-3Y2UZXRE.js";import{a as T}from"./chunk-QAP7QYNJ.js";import{a as V}from"./chunk-U7I2NAGB.js";import"./chunk-FCOCPX37.js";import"./chunk-YZIVIYTJ.js";import{d as u,f as E,g as k,i as w,j as C,k as N,p as U,r as _}from"./chunk-DSHMKTRR.js";import"./chunk-ZEON36AT.js";import"./chunk-2MHBVPJL.js";import{a as D}from"./chunk-PIAC254L.js";import"./chunk-PND7Q2S5.js";import{a as P}from"./chunk-HOHR253E.js";import{f as I}from"./chunk-KR6BTNRN.js";import"./chunk-U3QUSVWF.js";import"./chunk-W5MTSLKP.js";import{a as F}from"./chunk-G6VSAEU6.js";import"./chunk-YL4IPD7P.js";import"./chunk-JRLU6R7W.js";import"./chunk-VUEJJNO2.js";import{Db as t,Eb as i,Fb as m,Jb as S,Nb as d,Qa as b,Ta as s,Ua as a,Xb as y,Yb as r,cb as x,ha as f,ia as c,ub as l}from"./chunk-XMVMWOPN.js";var G=class g{constructor(p,o,e,n,v,h){this.fb=p;this.preferencesService=o;this.profileService=e;this.busyService=n;this.accountService=v;this.toastService=h;this.prefs=this.preferencesService.getPreferences()}profileForm;prefs;removePhoto(){this.profileForm.get("photoUrl").setValue("")}updatePhoto(p){let o=p.target;if(o.files&&o.files[0]){let e=new FileReader;e.onload=n=>{this.profileForm.get("photoUrl").setValue(n.target.result)},e.readAsDataURL(o.files[0])}}ngOnInit(){this.profileForm=this.fb.group({firstName:["",u.required],lastName:["",u.required],email:["",[u.required,u.email]],photoUrl:[""],username:[""]}),this.profileForm.controls.firstName.setValue(this.prefs.profile.firstName),this.profileForm.controls.lastName.setValue(this.prefs.profile.lastName),this.profileForm.controls.email.setValue(this.prefs.user.email),this.profileForm.controls.photoUrl.setValue(this.prefs.profile.photoUrl),this.profileForm.controls.username.setValue(this.prefs.user.username)}onSubmit(){this.busyService.busy();let p={userId:this.prefs.user.id,firstName:this.profileForm.controls.firstName.value,lastName:this.profileForm.controls.lastName.value,photoUrl:this.profileForm.controls.photoUrl.value},o={id:this.prefs.user.id,accountEnabled:!0,email:this.profileForm.controls.email.value,username:this.profileForm.controls.username.value,role:this.prefs.user.role,permissions:this.prefs.user.permissions};this.accountService.editUser(o).subscribe(e=>{this.prefs.user=e,this.preferencesService.setPreferences(this.prefs),this.accountService.setUser(e)}),this.profileService.editProfile(p).subscribe(e=>{this.toastService.success("Profile updated successfully"),this.busyService.idle(),this.profileService.getProfile(this.prefs.user.id).subscribe(n=>{this.prefs.profile=n,this.preferencesService.setPreferences(this.prefs)})},e=>{this.toastService.error("Profile update failed"),this.busyService.idle()})}static \u0275fac=function(o){return new(o||g)(a(U),a(F),a(j),a(D),a(I),a(P))};static \u0275cmp=x({type:g,selectors:[["app-profile"]],decls:53,vars:19,consts:[["fileInput",""],[1,"bg-gray-50","dark:bg-neutral-900"],[1,"py-6"],[1,"px-4","mx-auto","sm:px-6","md:px-8"],[1,"max-w-md"],[1,"text-lg","font-bold","text-gray-900","dark:text-white","dark:text-white"],[1,"mt-2","text-sm","font-medium","leading-6","text-gray-500"],[1,"px-4","mx-auto","mt-8","sm:px-6","md:px-8"],[1,"mt-8"],[1,"text-base","font-bold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","font-medium","text-gray-500"],[1,"mt-6","border-gray-200"],[1,"max-w-5xl","mt-12",3,"formGroup"],[1,"space-y-8"],[1,"sm:grid","sm:grid-cols-3","sm:gap-5","sm:items-start"],["for","profilePhoto",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"mt-2","sm:mt-0","sm:col-span-2"],[1,"flex","items-center","space-x-6"],["loading","lazy","alt","",1,"flex-shrink-0","object-cover","w-12","h-12","rounded-lg",3,"src"],["type","button",1,"text-sm","font-semibold","text-gray-400","transition-all","duration-200","rounded-md","hover:text-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-600",3,"click"],["type","button",1,"text-sm","font-semibold","text-indigo-600","transition-all","duration-200","rounded-md","hover:text-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600",3,"click"],["type","file",2,"display","none",3,"change"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-x-4","gap-y-5"],[3,"type","formControl","placeholder","label"],[1,"sm:mt-px","sm:pt-2"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mt-6","sm:mt-12"],[1,"inline-flex","items-center","justify-center","px-5","py-3","text-sm","font-semibold","leading-4","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click","disabled"]],template:function(o,e){if(o&1){let n=S();t(0,"main",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),r(5," Settings "),i(),t(6,"p",6),r(7," Update your profile information below to keep your account up to date. "),i()()(),t(8,"div",7),m(9,"app-nav-bread-crumb"),t(10,"div",8)(11,"h1",9),r(12," Profile "),i(),t(13,"p",10),r(14," Please ensure your profile information is accurate and up-to-date. "),i()(),m(15,"hr",11),t(16,"form",12)(17,"div",13)(18,"div",14)(19,"label",15),r(20," Profile Photo "),i(),t(21,"div",16)(22,"div",17),m(23,"img",18),t(24,"button",19),d("click",function(){return f(n),c(e.removePhoto())}),r(25," Remove "),i(),t(26,"button",20),d("click",function(){f(n);let h=y(29);return c(h.click())}),r(27," Update "),i(),t(28,"input",21,0),d("change",function(h){return f(n),c(e.updatePhoto(h))}),i()()()(),t(30,"div",14)(31,"label",22),r(32," First & Last Name "),i(),t(33,"div",16)(34,"div",23)(35,"div"),m(36,"app-text-input",24),i(),t(37,"div"),m(38,"app-text-input",24),i()()()(),t(39,"div",14)(40,"label",22),r(41," Email Address "),i(),t(42,"div",16),m(43,"app-text-input",24),i()(),t(44,"div",14)(45,"div",25)(46,"label",26),r(47," Username "),i()(),t(48,"div",16),m(49,"app-text-input",24),i()()(),t(50,"div",27)(51,"button",28),d("click",function(){return f(n),c(e.profileForm.valid&&e.onSubmit())}),r(52," Update "),i()()()()()()}o&2&&(s(16),l("formGroup",e.profileForm),s(7),l("src",e.profileForm.get("photoUrl").value?e.profileForm.get("photoUrl").value:"../../../../assets/images/img.svg",b),s(13),l("type","text")("formControl",e.profileForm.get("firstName"))("placeholder","First Name")("label","first name"),s(2),l("type","text")("formControl",e.profileForm.get("lastName"))("placeholder","Last Name")("label","last name"),s(5),l("type","text")("formControl",e.profileForm.get("email"))("placeholder","Email")("label","email"),s(6),l("type","text")("formControl",e.profileForm.get("username"))("placeholder","Username")("label","username"),s(2),l("disabled",!e.profileForm.valid))},dependencies:[B,_,w,E,k,C,N,V,T],encapsulation:2})};export{G as ProfileComponent};
