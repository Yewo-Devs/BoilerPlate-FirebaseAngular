import{a as G,b as L}from"./chunk-G7KTS4S4.js";import"./chunk-AYLAZ3MS.js";import"./chunk-MF2AVFJR.js";import"./chunk-CLOGCBH5.js";import{a as D}from"./chunk-FQ6V52RQ.js";import{a as q}from"./chunk-BSU3UBUV.js";import"./chunk-P4WASEVS.js";import{a as F}from"./chunk-VDYRJCPG.js";import{a as j,c as T}from"./chunk-SNMFPFD6.js";import"./chunk-NHCOVMH4.js";import"./chunk-C7BR53PB.js";import"./chunk-4KEACNFI.js";import{d as m,f as w,g as C,i as E,j as U,k as N,l as _,m as k,n as P,o as V,p as R,r as I}from"./chunk-SPMPY3AK.js";import{f as M}from"./chunk-HGXZOI6N.js";import"./chunk-652GZLPA.js";import"./chunk-TOKC4HOE.js";import"./chunk-4TGDBMK4.js";import"./chunk-XHS7OS3V.js";import{a as A}from"./chunk-TPI4TS65.js";import"./chunk-TWQDPD4B.js";import"./chunk-MOHHWKAW.js";import"./chunk-U3QUSVWF.js";import"./chunk-XB25HVPP.js";import{Ab as a,Eb as S,Ib as g,La as b,Oa as n,Pa as d,Sb as y,Tb as r,Za as x,da as f,ea as v,pb as s,yb as e,zb as i}from"./chunk-KK5ZIUJ6.js";import"./chunk-4CLCTAJ7.js";var ee=(()=>{class h{constructor(p,o,t,l,c,u){this.fb=p,this.preferencesService=o,this.profileService=t,this.busyService=l,this.accountService=c,this.toastService=u,this.prefs=this.preferencesService.getPreferences(),this.permissions=["Account Management","Customer"]}removePhoto(){this.profileForm.get("photoUrl").setValue("")}updatePhoto(p){let o=p.target;if(o.files&&o.files[0]){let t=new FileReader;t.onload=l=>{this.profileForm.get("photoUrl").setValue(l.target.result)},t.readAsDataURL(o.files[0])}}ngOnInit(){this.profileForm=this.fb.group({firstName:["",m.required],lastName:["",m.required],email:["",[m.required,m.email]],role:["Admin",m.required],permissions:[[],m.required],password:["",m.required],photoUrl:[""],username:[""]})}onSubmit(){this.busyService.busy();let p={email:this.profileForm.controls.email.value,username:this.profileForm.controls.username.value,role:this.profileForm.controls.role.value,permissions:this.profileForm.controls.permissions.value,password:this.profileForm.controls.password.value,requireEmailVerification:!1};this.accountService.registerUser(p).subscribe(o=>{let t={userId:o.id,firstName:this.profileForm.controls.firstName.value,lastName:this.profileForm.controls.lastName.value,photoUrl:this.profileForm.controls.photoUrl.value};this.profileService.createProfile(t).subscribe(l=>{this.toastService.success("Profile created successfully"),this.profileForm.reset({firstName:"",lastName:"",email:"",role:"Admin",permissions:[],accountEnabled:!0,photoUrl:"",username:"",userToEdit:null}),this.busyService.idle()},l=>{this.toastService.error("Profile update failed"),this.busyService.idle()})})}static{this.\u0275fac=function(o){return new(o||h)(d(R),d(A),d(D),d(q),d(M),d(F))}}static{this.\u0275cmp=x({type:h,selectors:[["app-register-user"]],decls:66,vars:24,consts:[["fileInput",""],[1,"bg-gray-50","dark:bg-neutral-900"],[1,"py-6"],[1,"px-4","mx-auto","sm:px-6","md:px-8"],[1,"max-w-md"],[1,"text-lg","font-bold","text-gray-900","dark:text-white","dark:text-white"],[1,"px-4","mx-auto","mt-8","sm:px-6","md:px-8"],[1,"mt-6","border-gray-200"],[1,"max-w-5xl","mt-12",3,"formGroup"],[1,"space-y-8"],[1,"sm:grid","sm:grid-cols-3","sm:gap-5","sm:items-start"],["for","profilePhoto",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"mt-2","sm:mt-0","sm:col-span-2"],[1,"flex","items-center","space-x-6"],["alt","",1,"flex-shrink-0","object-cover","w-12","h-12","rounded-lg",3,"src"],["type","button",1,"text-sm","font-semibold","text-gray-400","transition-all","duration-200","rounded-md","hover:text-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-600",3,"click"],["type","button",1,"text-sm","font-semibold","text-indigo-600","transition-all","duration-200","rounded-md","hover:text-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600",3,"click"],["type","file",2,"display","none",3,"change"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white","sm:mt-px","sm:pt-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-x-4","gap-y-5"],[3,"type","formControl","placeholder","label"],[1,"sm:mt-px","sm:pt-2"],["for","",1,"block","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","role",1,"block","w-full","px-4","py-3","placeholder-gray-500","border","-gray-300","rounded-lg","focus:ring-gray-900","focus:border-gray-900","sm:text-sm","caret-gray-900"],["value","Admin"],["value","User"],["formControlName","permissions","placeholder","Select Permissions","styleClass","w-full",3,"options"],[1,"mt-6","sm:mt-12"],[1,"inline-flex","items-center","justify-center","px-5","py-3","text-sm","font-semibold","leading-4","text-white","transition-all","duration-200","bg-indigo-600","border","border-transparent","rounded-md","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-600","hover:bg-indigo-500",3,"click","disabled"]],template:function(o,t){if(o&1){let l=S();e(0,"main",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h1",5),r(5," Register User "),i()()(),e(6,"div",6),a(7,"hr",7),e(8,"form",8)(9,"div",9)(10,"div",10)(11,"label",11),r(12," Profile Photo "),i(),e(13,"div",12)(14,"div",13),a(15,"img",14),e(16,"button",15),g("click",function(){return f(l),v(t.removePhoto())}),r(17," Remove "),i(),e(18,"button",16),g("click",function(){f(l);let u=y(21);return v(u.click())}),r(19," Update "),i(),e(20,"input",17,0),g("change",function(u){return f(l),v(t.updatePhoto(u))}),i()()()(),e(22,"div",10)(23,"label",18),r(24," First & Last Name "),i(),e(25,"div",12)(26,"div",19)(27,"div"),a(28,"app-text-input",20),i(),e(29,"div"),a(30,"app-text-input",20),i()()()(),e(31,"div",10)(32,"label",18),r(33," Email Address "),i(),e(34,"div",12),a(35,"app-text-input",20),i()(),e(36,"div",10)(37,"label",18),r(38," Password "),i(),e(39,"div",12),a(40,"app-text-input",20),i()(),e(41,"div",10)(42,"div",21)(43,"label",22),r(44," Username "),i()(),e(45,"div",12),a(46,"app-text-input",20),i()(),e(47,"div",10)(48,"div",21)(49,"label",22),r(50," Role "),i()(),e(51,"div",12)(52,"select",23)(53,"option",24),r(54,"Admin"),i(),e(55,"option",25),r(56,"User"),i()()()(),e(57,"div",10)(58,"div",21)(59,"label",22),r(60," Permissions "),i()(),e(61,"div",12),a(62,"p-multiselect",26),i()()(),e(63,"div",27)(64,"button",28),g("click",function(){return f(l),v(t.profileForm.valid&&t.onSubmit())}),r(65," Register "),i()()()()()()}o&2&&(n(8),s("formGroup",t.profileForm),n(7),s("src",t.profileForm.get("photoUrl").value?t.profileForm.get("photoUrl").value:"../../../../assets/images/img.svg",b),n(13),s("type","text")("formControl",t.profileForm.get("firstName"))("placeholder","First Name")("label","first name"),n(2),s("type","text")("formControl",t.profileForm.get("lastName"))("placeholder","Last Name")("label","last name"),n(5),s("type","text")("formControl",t.profileForm.get("email"))("placeholder","Email")("label","email"),n(5),s("type","password")("formControl",t.profileForm.get("password"))("placeholder","Password")("label","password"),n(6),s("type","text")("formControl",t.profileForm.get("username"))("placeholder","Username")("label","username"),n(16),s("options",t.permissions),n(2),s("disabled",!t.profileForm.valid))},dependencies:[I,E,P,V,k,w,C,U,N,_,T,j,L,G],encapsulation:2})}}return h})();export{ee as RegisterUserComponent};
